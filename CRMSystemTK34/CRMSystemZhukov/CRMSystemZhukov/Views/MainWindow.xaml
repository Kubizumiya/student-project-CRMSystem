<Window x:Class="CRMSystemZhukov.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:CRMSystemZhukov.ViewModels"
        mc:Ignorable="d"
        Title="CRM System" Height="600" Width="1300" MinHeight="500" MinWidth="1100"
        Background="{StaticResource BackgroundBrush}"
        WindowStartupLocation="CenterScreen"
        WindowStyle="None" AllowsTransparency="True" ResizeMode="CanResize"
        Loaded="Window_Loaded">
    <Window.DataContext>
        <local:ClientsViewModel/>
    </Window.DataContext>
    <Window.Resources>
        <local:NullToBoolConverter x:Key="NullToBool" />
        <!-- Градиент для фона -->
        <LinearGradientBrush x:Key="MainGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#23272E" Offset="0"/>
            <GradientStop Color="#2C313A" Offset="1"/>
        </LinearGradientBrush>
        <!-- Цветовые метки для статусов -->
        <SolidColorBrush x:Key="StatusActive" Color="#4F8EF7"/>
        <SolidColorBrush x:Key="StatusInactive" Color="#E81123"/>
        <SolidColorBrush x:Key="StatusPending" Color="#F7B84F"/>
    </Window.Resources>
    <Grid Background="{StaticResource MainGradient}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <!-- Верхняя панель -->
        <Border Grid.Row="0" Height="64" Background="{StaticResource PanelBrush}" Effect="{StaticResource ShadowEffect}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <!-- Логотип -->
                <TextBlock Grid.Column="0" FontFamily="Segoe MDL2 Assets" Text="&#xE8D4;" FontSize="32" Foreground="{StaticResource AccentBrush}" VerticalAlignment="Center" Margin="20,0,8,0"/>
                <TextBlock Grid.Column="1" Text="CRM System" VerticalAlignment="Center" FontWeight="Bold" FontSize="22" Foreground="{StaticResource TextBrush}" FontFamily="Segoe UI"/>
                <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,24,0">
                    <Button Width="40" Height="40" Padding="0" Click="MinimizeButton_Click" Background="{StaticResource PanelBrush}" BorderThickness="0" ToolTip="Свернуть"
                            Cursor="Hand" Style="{StaticResource IconButton}">
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE921;" FontSize="22" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="{StaticResource TextBrush}"/>
                    </Button>
                    <Button Width="40" Height="40" Padding="0" Click="CloseButton_Click" Background="#FFF" BorderThickness="0" ToolTip="Закрыть" Margin="8,0,0,0"
                            Cursor="Hand" Style="{StaticResource IconButton}">
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE8BB;" FontSize="22" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="{StaticResource ErrorBrush}"/>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>
        <!-- Поиск и кнопки -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="32,18,32,18" VerticalAlignment="Center" >
            <TextBox Style="{StaticResource WatermarkTextBox}"
                     Height="40" Width="260" Margin="0,0,20,0"
                     FontSize="16"
                     VerticalContentAlignment="Center"
                     Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                     ToolTip="Поиск по имени, телефону..."/>
            <Button Style="{StaticResource IconButton}" Background="{StaticResource AccentBrush}" Command="{Binding AddClientCommand}">
                <StackPanel Orientation="Horizontal">
                    <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE710;" Margin="0,0,8,0" FontSize="18"/>
                    <TextBlock Text="Добавить клиента"/>
                </StackPanel>
            </Button>
            <Button Style="{StaticResource IconButton}" Background="#F7B84F" Command="{Binding EditClientCommand}" IsEnabled="{Binding SelectedClient, Converter={StaticResource NullToBool}}">
                <StackPanel Orientation="Horizontal">
                    <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE70F;" Margin="0,0,8,0" FontSize="18"/>
                    <TextBlock Text="Редактировать"/>
                </StackPanel>
            </Button>
            <Button Style="{StaticResource IconButton}" Background="#E81123" Command="{Binding DeleteClientCommand}" IsEnabled="{Binding SelectedClient, Converter={StaticResource NullToBool}}">
                <StackPanel Orientation="Horizontal">
                    <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE74D;" Margin="0,0,8,0" FontSize="18"/>
                    <TextBlock Text="Удалить"/>
                </StackPanel>
            </Button>
            <Button Style="{StaticResource IconButton}" Background="#2C313A" Click="OpenMarketing_Click">
                <StackPanel Orientation="Horizontal">
                    <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE7BE;" Margin="0,0,8,0" FontSize="18"/>
                    <TextBlock Text="Маркетинг"/>
                </StackPanel>
            </Button>
            <Button Style="{StaticResource IconButton}" Background="#2C313A" Click="OpenDeals_Click">
                <StackPanel Orientation="Horizontal">
                    <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE8D1;" Margin="0,0,8,0" FontSize="18"/>
                    <TextBlock Text="Продажи"/>
                </StackPanel>
            </Button>
            <Button Style="{StaticResource IconButton}" Background="#2C313A" Click="OpenAnalytics_Click">
                <StackPanel Orientation="Horizontal">
                    <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE9D9;" Margin="0,0,8,0" FontSize="18"/>
                    <TextBlock Text="Аналитика"/>
                </StackPanel>
            </Button>
            <Button Style="{StaticResource IconButton}" Background="#2C313A" Click="OpenAutomation_Click">
                <StackPanel Orientation="Horizontal">
                    <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE7C3;" Margin="0,0,8,0" FontSize="18"/>
                    <TextBlock Text="Автоматизация"/>
                </StackPanel>
            </Button>
        </StackPanel>
        <!-- Разделитель -->
        <Border Grid.Row="2" Height="1" Background="{StaticResource BorderBrush}" Margin="32,0,32,0"/>
        <!-- Основной контент -->
        <Border Grid.Row="2" Margin="32,8,32,32" Padding="16" Background="{StaticResource PanelBrush}" CornerRadius="12" Effect="{StaticResource ShadowEffect}">
            <DataGrid ItemsSource="{Binding FilteredClients}" SelectedItem="{Binding SelectedClient, Mode=TwoWay}" Margin="0" AutoGenerateColumns="True"
                      RowBackground="#262B33" AlternatingRowBackground="#23272E" HeadersVisibility="Column" GridLinesVisibility="None"
                      ColumnHeaderHeight="44" RowHeight="44" FontSize="15" Foreground="{StaticResource TextBrush}" Background="Transparent"
                      BorderThickness="0" CanUserResizeRows="False" CanUserResizeColumns="True" CanUserSortColumns="True">
                <DataGrid.Resources>
                    <!-- Кастомные скроллбары -->
                    <Style TargetType="ScrollBar">
                        <Setter Property="Background" Value="#23272E"/>
                        <Setter Property="Foreground" Value="#4F8EF7"/>
                        <Setter Property="Width" Value="8"/>
                        <Setter Property="Height" Value="8"/>
                    </Style>
                </DataGrid.Resources>
            </DataGrid>
        </Border>
    </Grid>
</Window> 